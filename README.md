# üîå Pro–°–≤—ñ—Ç–ª–æ - Backend

**Backend –¥–ª—è –¥–æ–¥–∞—Ç–∫–∞ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –≤—ñ–¥–∫–ª—é—á–µ–Ω—å –µ–ª–µ–∫—Ç—Ä–æ–µ–Ω–µ—Ä–≥—ñ—ó**

FastAPI —Å–µ—Ä–≤–µ—Ä, —è–∫–∏–π:
- üåê –ü–∞—Ä—Å–∏—Ç—å –¥–∞–Ω—ñ –ø—Ä–æ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑ –æ—Ñ—ñ—Ü—ñ–π–Ω–∏—Ö –¥–∂–µ—Ä–µ–ª
- üíæ –ó–±–µ—Ä—ñ–≥–∞—î —ñ—Å—Ç–æ—Ä—ñ—é –≤—ñ–¥–∫–ª—é—á–µ–Ω—å —É SQLite –±–∞–∑—ñ –¥–∞–Ω–∏—Ö
- üîî –í—ñ–¥–ø—Ä–∞–≤–ª—è—î push-–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ Firebase Cloud Messaging
- ‚è∞ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–Ω–æ–≤–ª—é—î –¥–∞–Ω—ñ –∑–∞ —Ä–æ–∑–∫–ª–∞–¥–æ–º
- üìç –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –±–∞–∑–æ—é –∞–¥—Ä–µ—Å: [prosvitlo-addresses-db](https://github.com/Elvis129/prosvitlo-addresses-db)
- üöÄ REST API –∑ –ø–æ–≤–Ω–æ—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—î—é

---

## üìã –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó

- **Python 3.11+**
- **FastAPI** - –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **SQLAlchemy** - ORM –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –ë–î
- **SQLite** - –ª–æ–∫–∞–ª—å–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö
- **BeautifulSoup4** + **Selenium** - –ø–∞—Ä—Å–∏–Ω–≥ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–æ–∫
- **APScheduler** - –ø–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫ –∑–∞–¥–∞—á
- **Firebase Admin SDK** - push-–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

---

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### 1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó –ø—Ä–æ–µ–∫—Ç—É

```bash
cd prosvitlo-backend
```

### 2. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é

```bash
git clone https://github.com/Elvis129/prosvitlo-backend.git
cd prosvitlo-backend
```

### 2. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞

```bash
python3 -m venv venv
source venv/bin/activate  # macOS/Linux
# –∞–±–æ venv\Scripts\activate –¥–ª—è Windows
```

### 3. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 4. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

```bash
cp .env.example .env
```

–í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ `.env`:
- –î–æ–¥–∞–π—Ç–µ Firebase credentials –¥–ª—è push-–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
- –ù–∞–ª–∞—à—Ç—É–π—Ç–µ Telegram bot token (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

### 5. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
./start.sh
# –∞–±–æ
uvicorn app.main:app --reload
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –∑–∞ –∞–¥—Ä–µ—Å–æ—é: **http://localhost:8000**
### –û—Å–Ω–æ–≤–Ω—ñ endpoints:

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å |
|-------|----------|------|
| `GET` | `/` | –ì–æ–ª–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ |
| `GET` | `/health` | –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤'—è —Å–µ—Ä–≤–µ—Ä–∞ |
| `GET` | `/api/v1/status` | –°—Ç–∞—Ç—É—Å API —Ç–∞ scheduler |
| `GET` | `/api/v1/outages` | –°–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö –≤—ñ–¥–∫–ª—é—á–µ–Ω—å (–∑ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—î—é) |
| `GET` | `/api/v1/outage` | –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑–∞ –∞–¥—Ä–µ—Å–æ—é |
| `POST` | `/api/v1/register` | –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–ª—è push-–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å |
| `GET` | `/api/v1/history` | –Ü—Å—Ç–æ—Ä—ñ—è –≤—ñ–¥–∫–ª—é—á–µ–Ω—å –¥–ª—è –∞–¥—Ä–µ—Å–∏ |
| `GET` | `/api/v1/cities` | –°–ø–∏—Å–æ–∫ –º—ñ—Å—Ç |
| `GET` | `/api/v1/scheduler-status` | –°—Ç–∞—Ç—É—Å –ø–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫–∞ |

### –ü—Ä–∏–∫–ª–∞–¥–∏ –∑–∞–ø–∏—Ç—ñ–≤:

## üìñ API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

–ü—ñ—Å–ª—è –∑–∞–ø—É—Å–∫—É —Å–µ—Ä–≤–µ—Ä–∞ –≤—ñ–¥–∫—Ä–∏–π—Ç–µ —É –±—Ä–∞—É–∑–µ—Ä—ñ:

- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

### –û—Å–Ω–æ–≤–Ω—ñ endpoints:

| Endpoint | –û–ø–∏—Å |
|----------|------|
| `GET /health` | –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤'—è —Å–µ—Ä–≤–µ—Ä–∞ |
| `GET /api/v1/status` | –°—Ç–∞—Ç—É—Å API —Ç–∞ scheduler |
| `GET /api/v1/address-outages` | –í—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑–∞ –∞–¥—Ä–µ—Å–æ—é |
| `GET /api/v1/addresses/cities` | –°–ø–∏—Å–æ–∫ –º—ñ—Å—Ç |
| `POST /api/v1/tokens/register` | –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è device token |
| `GET /api/v1/schedules/current` | –ü–æ—Ç–æ—á–Ω—ñ –≥—Ä–∞—Ñ—ñ–∫–∏ | ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ notifier.py      # Firebase push-–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ requirements.txt         # Python –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
‚îú‚îÄ‚îÄ .env.example            # –ü—Ä–∏–∫–ª–∞–¥ .env —Ñ–∞–π–ª—É
‚îú‚îÄ‚îÄ .gitignore
‚îî‚îÄ‚îÄ README.md
```

---

## ‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

–°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `.env` —ñ –≤—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏:

```env
# –Ü–Ω—Ç–µ—Ä–≤–∞–ª –ø–∞—Ä—Å–∏–Ω–≥—É (–≤ —Ö–≤–∏–ª–∏–Ω–∞—Ö)
---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
prosvitlo-backend/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ main.py              # –ì–æ–ª–æ–≤–Ω–∏–π —Ñ–∞–π–ª FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ config.py            # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
‚îÇ   ‚îú‚îÄ‚îÄ database.py          # –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ models.py            # SQLAlchemy –º–æ–¥–µ–ª—ñ
‚îÇ   ‚îú‚îÄ‚îÄ scheduler.py         # –ü–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫ –∑–∞–¥–∞—á
‚îÇ   ‚îú‚îÄ‚îÄ api/                 # API endpoints
‚îÇ   ‚îú‚îÄ‚îÄ scraper/             # –ü–∞—Ä—Å–µ—Ä–∏
‚îÇ   ‚îú‚îÄ‚îÄ services/            # Firebase, Telegram, Addresses
‚îÇ   ‚îî‚îÄ‚îÄ utils/               # –î–æ–ø–æ–º—ñ–∂–Ω—ñ —É—Ç–∏–ª—ñ—Ç–∏
‚îú‚îÄ‚îÄ cache/                   # –ö–µ—à –∞–¥—Ä–µ—Å (–Ω–µ –≤ git)
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ .env.example
‚îî‚îÄ‚îÄ start.sh
```

---

## ‚öôÔ∏è –û—Å–Ω–æ–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó

### ü§ñ Scheduler (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –∑–∞–¥–∞—á—ñ)
- ‚è∞ –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫—ñ–≤: –∫–æ–∂–Ω—ñ 5 —Ö–≤–∏–ª–∏–Ω
- ‚ö†Ô∏è –ê–≤–∞—Ä—ñ–π–Ω—ñ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: –∫–æ–∂–Ω—ñ 5 —Ö–≤–∏–ª–∏–Ω
- üìã –ü–ª–∞–Ω–æ–≤—ñ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: —â–æ–¥–Ω—è –æ 9:00
- üì¢ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ–≥–æ–ª–æ—à–µ–Ω—å: –∫–æ–∂–Ω—ñ 5 —Ö–≤–∏–ª–∏–Ω
- üîî –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –∑–∞ 5 —Ö–≤–∏–ª–∏–Ω –¥–æ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è

### üìç –°–∏—Å—Ç–µ–º–∞ –∞–¥—Ä–µ—Å
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑ GitHub
- –õ–æ–∫–∞–ª—å–Ω–µ –∫–µ—à—É–≤–∞–Ω–Ω—è –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é –≤–µ—Ä—Å—ñ–π
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ 1200+ –º—ñ—Å—Ç –£–∫—Ä–∞—ó–Ω–∏

### üîî Push-–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- Firebase Cloud Messaging
- Telegram –±–æ—Ç –¥–ª—è –æ–≥–æ–ª–æ—à–µ–Ω—å (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
- –ì—Ä—É–ø–æ–≤–∞ —Ä–æ–∑—Å–∏–ª–∫–∞ –ø–æ –∞–¥—Ä–µ—Å–∞—Ö